{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\richg\\\\Documents\\\\Projects\\\\Op_Tracker\\\\client\\\\src\\\\components\\\\TrackerTable.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport operFinder from '../apis/operFinder';\nimport Chart from 'react-apexcharts';\nimport { OperContext } from '../context/OperContext';\nimport { AuthoContext } from '../context/AuthContext';\nimport { useTable, useSortBy, useFilters } from 'react-table';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst TrackerTable = () => {\n  _s();\n\n  // Call upon the commodities state object from with the Table\n  // (all server fetching and updating will occurs in this component vice the TrackerChart)\n  const {\n    commodities,\n    setCommodities,\n    addCommodities\n  } = useContext(OperContext);\n  const {\n    isLoggedIn,\n    setIsLoggedIn\n  } = useContext(AuthoContext); // Define a state for saving the id of the tracker information for updating the database\n\n  const [trackID, setTrackID] = useState(1); // Define a state for saving identifying when the Tracker Data is loaded to know when to show data\n\n  const [isLoaded, setIsLoaded] = useState(false); // Define a state for showing a pop-up modal when editing tracker data\n\n  const [showTrackModal, setShowTrackModal] = useState(false); // Define a state for setting whether the modal is for adding a new record (true) or updating an old (false)\n\n  const [trackModalAdd, setTrackModalAdd] = useState(true); // Define a state for saving the chart data of the commodity information in the proper form\n\n  const [chartData, setChartData] = useState({\n    // Define a dummy series set before the real data is pulled from the \n    series: [{\n      name: 'XXX',\n      data: [1]\n    }],\n    options: {\n      chart: {\n        type: 'bar',\n        height: 450,\n        stacked: true,\n        toolbar: {\n          show: true\n        },\n        zoom: {\n          enabled: true\n        }\n      },\n      responsive: [{\n        breakpoint: 480,\n        options: {\n          legend: {\n            position: 'bottom',\n            offsetX: -10,\n            offsetY: 0\n          }\n        }\n      }],\n      plotOptions: {\n        bar: {\n          horizontal: false,\n          borderRadius: 10\n        }\n      },\n      xaxis: {\n        categories: ['XXX']\n      },\n      legend: {\n        position: 'right',\n        offsetY: 40\n      },\n      fill: {\n        opacity: 1\n      }\n    }\n  }); // Fetch commidity data from tracker table in database - only do this once on page load\n\n  useEffect(() => {\n    const fetchTrackerData = async () => {\n      try {\n        // The axios get request is added to the baseURL value\n        const response = await operFinder.get(\"api/v1/tracker/\");\n        setCommodities(response.data.data);\n        setIsLoaded(true);\n      } catch (e) {\n        console.log(e);\n      }\n\n      ;\n    };\n\n    fetchTrackerData();\n  }, []); // Update chart data whenever 'commodities' changes after first render\n\n  useEffect(() => {\n    if (isLoaded) {\n      // Specify Chart data object with 'series' and 'options' parameters\n      let newData = commodities.map(elem => {\n        // Use destructuring to pull out all just metric data\n        const {\n          id,\n          AAA,\n          ...metricData\n        } = elem;\n        return {\n          name: AAA,\n          data: Object.values(metricData)\n        };\n      }); // Specify categories titles\n\n      let cateNames = Object.keys(commodities[0]).slice(2);\n      setChartData({\n        series: newData,\n        options: { ...chartData.options,\n          xaxis: {\n            categories: cateNames\n          }\n        }\n      });\n    }\n  }, [commodities, isLoaded]); // Update Function: Open tracker modal and fill with current commodity data\n\n  const handleUpdate = (e, id) => {\n    setTrackID(id);\n    setTrackModalAdd(false);\n    setShowTrackModal(!showTrackModal);\n  }; // Add Function: Open tracker (Table) modal\n\n\n  const handleAdd = e => {\n    setTrackModalAdd(true);\n    setShowTrackModal(!showTrackModal);\n  }; // Define function for deleting a record from database\n\n\n  const handleDelete = async (e, id) => {\n    try {\n      const response = await operFinder.delete(`api/v1/tracker/${id}`);\n      console.log(\"Commodity successfully deleted\");\n      setCommodities(commodities.filter(commodity => {\n        return commodity.id !== id;\n      }));\n    } catch (e) {\n      console.log(e);\n    }\n\n    ;\n  }; // Define list of objects to coincide with ReactTable Format - Changes to Tracker table (adding a column) must be reflected here\n\n\n  const columns = React.useMemo(() => [{\n    Header: 'AAA',\n    accessor: 'AAA'\n  }, {\n    Header: 'BBB',\n    accessor: 'BBB'\n  }, {\n    Header: 'CCC',\n    accessor: 'CCC'\n  }, {\n    Header: 'DDD',\n    accessor: 'DDD'\n  }, {\n    Header: 'EEE',\n    accessor: 'EEE'\n  }, {\n    Header: 'FFF',\n    accessor: 'FFF'\n  }, {\n    Header: 'GGG',\n    accessor: 'GGG'\n  }, {\n    Header: 'HHH',\n    accessor: 'HHH'\n  }, {\n    Header: 'III',\n    accessor: 'III'\n  }, {\n    Header: 'JJJ',\n    accessor: 'JJJ'\n  }, {\n    Header: 'KKK',\n    accessor: 'KKK'\n  }, {\n    Header: 'LLL',\n    accessor: 'LLL'\n  }, {\n    Header: 'MMM',\n    accessor: 'MMM'\n  }, {\n    Header: 'NNN',\n    accessor: 'NNN'\n  }, {\n    Header: 'OOO',\n    accessor: 'OOO'\n  }, {\n    Header: 'PPP',\n    accessor: 'PPP'\n  }, {\n    Header: 'QQQ',\n    accessor: 'QQQ'\n  }, {\n    Header: 'RRR',\n    accessor: 'RRR'\n  }, {\n    Header: 'SSS',\n    accessor: 'SSS'\n  }, {\n    Header: 'TTT',\n    accessor: 'TTT'\n  }, {\n    Header: 'UUU',\n    accessor: 'UUU'\n  }], []); // Define data in a memo-ized format for displaying in react\n\n  const data = React.useMemo(() => commodities); // define the Table structure with the useTable hook\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    setFilter\n  } = useTable({\n    columns,\n    data\n  }, useFilters, useSortBy); // Define a custom function for rendering Tracker Table (necessary for small time before fetch request of data)\n\n  const renderTable = () => {\n    if (!isLoaded) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loading\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 20\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"table\", { ...getTableProps(),\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: headerGroups.map(headerGroup => /*#__PURE__*/_jsxDEV(\"tr\", { ...headerGroup.getHeaderGroupProps(),\n            children: [headerGroup.headers.map(column =>\n            /*#__PURE__*/\n            // Add sorting option for each column\n            _jsxDEV(\"th\", { ...column.getHeaderProps(column.getSortByToggleProps()),\n              className: column.isSorted ? column.isSortedDesc ? \"sort-desc\" : \"sort-asc\" : \"\",\n              children: [column.render(\"Header\"), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: column.isSorted ? column.isSortedDesc ? 'ðŸ”½' : 'ðŸ”¼' : ''\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 37\n            }, this)), isLoggedIn ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                colspan: \"1\",\n                role: \"columnheader\",\n                children: \"Update\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                colspan: \"1\",\n                role: \"columnheader\",\n                children: \"Delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", { ...getTableBodyProps(),\n          children: rows.map((row, i) => {\n            prepareRow(row);\n            return /*#__PURE__*/_jsxDEV(\"tr\", { ...row.getRowProps(),\n              children: [row.cells.map(cell => {\n                return /*#__PURE__*/_jsxDEV(\"td\", { ...cell.getCellProps(),\n                  children: cell.render(\"Cell\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 44\n                }, this);\n              }), isLoggedIn ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  role: \"cell\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: e => handleUpdate(e, row.cells.original.id),\n                    className: \"btn btn-warning\",\n                    children: \"Update\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 248,\n                    columnNumber: 53\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  role: \"cell\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: e => handleDelete(e, row.cells.original.id),\n                    className: \"btn btn-danger\",\n                    children: \"Delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 249,\n                    columnNumber: 53\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 33\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Chart Technical Operations Data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Chart, {\n      options: chartData.options,\n      series: chartData.series,\n      type: \"bar\",\n      height: \"600\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Tabular Technical Operations Data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 13\n    }, this), renderTable(), isLoggedIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: e => handleAdd(e),\n      className: \"trackAdd\",\n      children: \"\\uD83D\\uDD3D ADD LINE\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 17\n    }, this) : '']\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 9\n  }, this);\n};\n\n_s(TrackerTable, \"whTPaDndVrz32buerPdh2SA0+RA=\", false, function () {\n  return [useTable];\n});\n\n_c = TrackerTable;\nexport default TrackerTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"TrackerTable\");","map":{"version":3,"sources":["C:/Users/richg/Documents/Projects/Op_Tracker/client/src/components/TrackerTable.jsx"],"names":["React","useEffect","useState","useContext","operFinder","Chart","OperContext","AuthoContext","useTable","useSortBy","useFilters","TrackerTable","commodities","setCommodities","addCommodities","isLoggedIn","setIsLoggedIn","trackID","setTrackID","isLoaded","setIsLoaded","showTrackModal","setShowTrackModal","trackModalAdd","setTrackModalAdd","chartData","setChartData","series","name","data","options","chart","type","height","stacked","toolbar","show","zoom","enabled","responsive","breakpoint","legend","position","offsetX","offsetY","plotOptions","bar","horizontal","borderRadius","xaxis","categories","fill","opacity","fetchTrackerData","response","get","e","console","log","newData","map","elem","id","AAA","metricData","Object","values","cateNames","keys","slice","handleUpdate","handleAdd","handleDelete","delete","filter","commodity","columns","useMemo","Header","accessor","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","setFilter","renderTable","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","isSorted","isSortedDesc","render","row","i","getRowProps","cells","cell","getCellProps","original"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport operFinder from '../apis/operFinder';\r\nimport Chart from 'react-apexcharts';\r\nimport { OperContext } from '../context/OperContext';\r\nimport { AuthoContext } from '../context/AuthContext';\r\nimport { useTable, useSortBy, useFilters, } from 'react-table';\r\n\r\nconst TrackerTable = () => {\r\n\r\n    // Call upon the commodities state object from with the Table\r\n    // (all server fetching and updating will occurs in this component vice the TrackerChart)\r\n    const { commodities, setCommodities, addCommodities } = useContext(OperContext);\r\n    const { isLoggedIn, setIsLoggedIn } = useContext(AuthoContext);\r\n\r\n    // Define a state for saving the id of the tracker information for updating the database\r\n    const [ trackID, setTrackID ] = useState(1)\r\n    // Define a state for saving identifying when the Tracker Data is loaded to know when to show data\r\n    const [ isLoaded, setIsLoaded ] = useState(false)\r\n    // Define a state for showing a pop-up modal when editing tracker data\r\n    const [ showTrackModal, setShowTrackModal ] = useState(false);\r\n    // Define a state for setting whether the modal is for adding a new record (true) or updating an old (false)\r\n    const [ trackModalAdd, setTrackModalAdd ] = useState(true);\r\n\r\n    // Define a state for saving the chart data of the commodity information in the proper form\r\n    const [ chartData, setChartData ] = useState({\r\n        // Define a dummy series set before the real data is pulled from the \r\n        series: [{\r\n            name: 'XXX',\r\n            data: [1]\r\n          }],\r\n        options: {\r\n            chart: {\r\n                type: 'bar',\r\n                height: 450,\r\n                stacked: true,\r\n                toolbar: {\r\n                    show: true\r\n                },\r\n                zoom: {\r\n                    enabled: true\r\n                }\r\n            },\r\n            responsive: [{\r\n                breakpoint: 480,\r\n                options: {\r\n                legend: {\r\n                    position: 'bottom',\r\n                    offsetX: -10,\r\n                    offsetY: 0\r\n                }\r\n                }\r\n            }],\r\n            plotOptions: {\r\n                bar: {\r\n                horizontal: false,\r\n                borderRadius: 10\r\n                },\r\n            },\r\n            xaxis: {\r\n                categories: ['XXX'],\r\n            },\r\n            legend: {\r\n                position: 'right',\r\n                offsetY: 40\r\n            },\r\n            fill: {\r\n                opacity: 1\r\n            }\r\n        },\r\n    });\r\n\r\n    // Fetch commidity data from tracker table in database - only do this once on page load\r\n    useEffect(() => {\r\n        const fetchTrackerData = async () => {\r\n            try {\r\n                // The axios get request is added to the baseURL value\r\n                const response = await operFinder.get(\"api/v1/tracker/\");\r\n                setCommodities(response.data.data);\r\n                setIsLoaded(true);\r\n            } catch (e) {\r\n                console.log(e);\r\n            };\r\n        };\r\n        fetchTrackerData();\r\n        \r\n    }, []);\r\n\r\n    // Update chart data whenever 'commodities' changes after first render\r\n    useEffect(() => {\r\n        if (isLoaded) {\r\n            // Specify Chart data object with 'series' and 'options' parameters\r\n            let newData = commodities.map((elem) => {\r\n                // Use destructuring to pull out all just metric data\r\n                const { id, AAA, ...metricData } = elem;\r\n                return {\r\n                    name: AAA,\r\n                    data: Object.values(metricData)\r\n                }\r\n            });\r\n            // Specify categories titles\r\n            let cateNames = Object.keys(commodities[0]).slice(2);\r\n\r\n            setChartData(\r\n                {\r\n                    series: newData,\r\n                    options: {\r\n                        ...chartData.options,\r\n                        xaxis: {\r\n                            categories: cateNames\r\n                        }\r\n                    }\r\n                }\r\n            );}\r\n    }, [commodities, isLoaded])\r\n\r\n    // Update Function: Open tracker modal and fill with current commodity data\r\n    const handleUpdate = (e, id) => {\r\n        setTrackID(id);\r\n        setTrackModalAdd(false);\r\n        setShowTrackModal(!showTrackModal);\r\n    };\r\n\r\n    // Add Function: Open tracker (Table) modal\r\n    const handleAdd = (e) => {\r\n        setTrackModalAdd(true);\r\n        setShowTrackModal(!showTrackModal);\r\n    };\r\n\r\n    // Define function for deleting a record from database\r\n    const handleDelete = async (e, id) => {\r\n        try {\r\n            const response = await operFinder.delete(`api/v1/tracker/${id}`);\r\n            console.log(\"Commodity successfully deleted\");\r\n            setCommodities(commodities.filter(commodity => {\r\n                return commodity.id !== id;\r\n            }));\r\n        } catch (e) {\r\n            console.log(e);\r\n        };\r\n    };\r\n\r\n    // Define list of objects to coincide with ReactTable Format - Changes to Tracker table (adding a column) must be reflected here\r\n    const columns = React.useMemo(() => [\r\n        {   Header: 'AAA',\r\n            accessor: 'AAA'},\r\n        {   Header: 'BBB',\r\n            accessor: 'BBB'},\r\n        {   Header: 'CCC',\r\n            accessor: 'CCC'},\r\n        {   Header: 'DDD',\r\n            accessor: 'DDD'},\r\n        {   Header: 'EEE',\r\n            accessor: 'EEE'},\r\n        {   Header: 'FFF',\r\n            accessor: 'FFF'},\r\n        {   Header: 'GGG',\r\n            accessor: 'GGG'},\r\n        {   Header: 'HHH',\r\n            accessor: 'HHH'},\r\n        {   Header: 'III',\r\n            accessor: 'III'},\r\n        {   Header: 'JJJ',\r\n            accessor: 'JJJ'},\r\n        {   Header: 'KKK',\r\n            accessor: 'KKK'},\r\n        {   Header: 'LLL',\r\n            accessor: 'LLL'},\r\n        {   Header: 'MMM',\r\n            accessor: 'MMM'},\r\n        {   Header: 'NNN',\r\n            accessor: 'NNN'},\r\n        {   Header: 'OOO',\r\n            accessor: 'OOO'},\r\n        {   Header: 'PPP',\r\n            accessor: 'PPP'},\r\n        {   Header: 'QQQ',\r\n            accessor: 'QQQ'},\r\n        {   Header: 'RRR',\r\n            accessor: 'RRR'},\r\n        {   Header: 'SSS',\r\n            accessor: 'SSS'},\r\n        {   Header: 'TTT',\r\n            accessor: 'TTT'},\r\n        {   Header: 'UUU',\r\n            accessor: 'UUU'}\r\n    ], []);\r\n    \r\n    // Define data in a memo-ized format for displaying in react\r\n    const data = React.useMemo(() => commodities);\r\n    \r\n    // define the Table structure with the useTable hook\r\n    const {\r\n        getTableProps,\r\n        getTableBodyProps,\r\n        headerGroups,\r\n        rows,\r\n        prepareRow,\r\n        setFilter\r\n    } = useTable({\r\n            columns,\r\n            data,\r\n        },\r\n        useFilters,\r\n        useSortBy);\r\n\r\n    // Define a custom function for rendering Tracker Table (necessary for small time before fetch request of data)\r\n    const renderTable = () => {\r\n        if (!isLoaded) {\r\n            return <div>Loading</div>\r\n        } else {\r\n            return (\r\n                <table {...getTableProps()}>\r\n                    <thead>\r\n                        {headerGroups.map(headerGroup => (\r\n                            <tr {...headerGroup.getHeaderGroupProps()}>\r\n                                {headerGroup.headers.map(column => (\r\n                                    // Add sorting option for each column\r\n                                    <th {...column.getHeaderProps(column.getSortByToggleProps())}\r\n                                    className={\r\n                                        column.isSorted ?\r\n                                            column.isSortedDesc ? \"sort-desc\" : \"sort-asc\"\r\n                                        : \"\"\r\n                                    }>{column.render(\"Header\")}\r\n                                    <span>\r\n                                        {column.isSorted ?\r\n                                            column.isSortedDesc ? 'ðŸ”½' : 'ðŸ”¼'\r\n                                        : ''}\r\n                                    </span>\r\n                                    </th>\r\n                                ))}\r\n                                {/* Add columns for update and delete buttons if Auth is logged in */}\r\n                                {isLoggedIn ? (<>\r\n                                    <th colspan=\"1\" role=\"columnheader\">Update</th>\r\n                                    <th colspan=\"1\" role=\"columnheader\">Delete</th>\r\n                                    </>) : null}\r\n                            </tr>\r\n                        ))}\r\n                    </thead>\r\n                    <tbody {...getTableBodyProps()}>\r\n                        {rows.map((row, i) => {\r\n                            prepareRow(row);\r\n                            return (\r\n                                <tr {...row.getRowProps()}>\r\n                                {row.cells.map(cell => {\r\n                                    return <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>;\r\n                                })}\r\n                                {isLoggedIn ? (<>\r\n                                    <td role=\"cell\"><button onClick={(e) => handleUpdate(e, row.cells.original.id)} className='btn btn-warning'>Update</button></td>\r\n                                    <td role=\"cell\"><button onClick={(e) => handleDelete(e, row.cells.original.id)} className='btn btn-danger'>Delete</button></td>\r\n                                    </>) : null}\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            )}\r\n        };\r\n\r\n    return (\r\n        <div className='main'>\r\n            <h2>Chart Technical Operations Data</h2>\r\n            <Chart options={chartData.options} series={chartData.series} type=\"bar\" height=\"600\" />\r\n            <h2>Tabular Technical Operations Data</h2>\r\n            {renderTable()}\r\n            {isLoggedIn ? (\r\n                <div onClick={(e) => handleAdd(e)} className='trackAdd'>ðŸ”½ ADD LINE</div>\r\n            ) : ''}\r\n        </div>);\r\n};\r\n\r\nexport default TrackerTable;"]},"metadata":{},"sourceType":"module"}